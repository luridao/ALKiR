{
    "contents" : "#------------------------------------------------------\n######\t\tYVIRLITST?LINI\t\t#######\n#------------------------------------------------------\n\n# Fleet categories for saithe\nSnella           <- data.frame(fleet=\"Snella\"           , drift=c(2,9,24))\nPartroplus1000   <- data.frame(fleet=\"Partroplus1000\"   , drift=c(19,20,21))\nPartrominus1000  <- data.frame(fleet=\"Partrominus1000\"  , drift=c(16,17,18))\nLemmatroplus1000 <- data.frame(fleet=\"Lemmatroplus1000\" , drift=c(13,14,15))\nAnnad1           <- data.frame(fleet=\"Annad1\"           , drift=c(1,4,5,6,7,8))\nAnnad2           <- data.frame(fleet=\"Annad2\"           , drift=c(10,11,12,22,23,28))\n\nfleetCategory_UP <- rbind(Snella, Partroplus1000, Partrominus1000, Lemmatroplus1000, Annad1, Annad2)\n\n#- if there exists a fleetCategory object then do the yvirlit according to it\nfleetCategory_question = exists(paste(\"fleetCategory\", Slag, sep=\"_\"))\n\n#------------------------------------------------------\n######\t\tLength Summary\t\t#######\n#------------------------------------------------------\n# ---- Monthly summary ----\n#yvirlit_lgd      <- with(lgdAll, lgdAll[slag %in% Slag & oeki %in% Oeki,]) # some samples have no 'Oeki' registered\nyvirlit_lgd       <- with(lgdAll, lgdAll[slag %in% Slag,])\nyvirlit_lgd$ls    <- as.character(bdrift[match(yvirlit_lgd$drift, bdrift$drift), 'lysing_stutt'])\nyvirlit_lgd       <- with(yvirlit_lgd, yvirlit_lgd[order(slag, arma, drift),])\nif(fleetCategory_question)\nyvirlit_lgd$ls1 <- fleetCategory_UP[match(yvirlit_lgd$drift, fleetCategory_UP$drift), 'fleet'] else {}\n\n# summary by 'drift'\nyvirlit_lgd_mand <- with(yvirlit_lgd, tapply(sum_matad, list(arma=arma, drift=drift),sum))\nyvirlit_lgd_mand[is.na(yvirlit_lgd_mand)] <- 0\n\nyvirlit_lgd_mand <- raetRow(yvirlit_lgd_mand)\n\n# summary by 'lysing_stutt'\nyvirlit_lgd_man <- with(yvirlit_lgd, tapply(sum_matad, list(arma=arma, ls=ls),sum))\nyvirlit_lgd_man[is.na(yvirlit_lgd_man)] <- 0\nncol_lgd        <- ncol(yvirlit_lgd_man)\nyvirlit_lgd_man\n\nyvirlit_lgd_man <- raetRow(yvirlit_lgd_man)\n\n# summary by 'ls1' fleetCategory_UP\nyvirlit_lgd_man1 <- with(yvirlit_lgd, tapply(sum_matad, list(arma=arma, ls=ls1),sum))\nyvirlit_lgd_man1[is.na(yvirlit_lgd_man1)] <- 0\nncol_lgd1        <- ncol(yvirlit_lgd_man1)\nyvirlit_lgd_man1\n\nyvirlit_lgd_man1 <- raetRow(yvirlit_lgd_man1)\n\n# ---- Quarter summary ---- by ls\nyvirlit_lgd_qrt           <- data.frame(yvirlit_lgd_man)\n#colnames(yvirlit_lgd_qrt) <- gsub('X', '', colnames(yvirlit_lgd_qrt))\nyvirlit_lgd_qrt$extra     <- rep(1:qrt, each = qrt.l)\nyvirlit_lgd_qrt           <- aggregate(yvirlit_lgd_qrt[,1:ncol_lgd], list(Qrt = yvirlit_lgd_qrt$extra), sum)\ncolnames(yvirlit_lgd_qrt) <- c('Qrt',colnames(yvirlit_lgd_man))\nyvirlit_lgd_qrt\n\n# ---- Quarter summary ---- by ls1\nyvirlit_lgd_qrt1           <- data.frame(yvirlit_lgd_man1)\n#colnames(yvirlit_lgd_qrt) <- gsub('X', '', colnames(yvirlit_lgd_qrt))\nyvirlit_lgd_qrt1$extra     <- rep(1:qrt, each = qrt.l)\nyvirlit_lgd_qrt1           <- aggregate(yvirlit_lgd_qrt1[,1:ncol_lgd1], list(Qrt = yvirlit_lgd_qrt1$extra), sum)\ncolnames(yvirlit_lgd_qrt1) <- c('Qrt',colnames(yvirlit_lgd_man1))\nyvirlit_lgd_qrt1\n\n#------------------------------------------------------\n######\t\tWeight Summary\t\t#######\n#------------------------------------------------------\n# ---- Monthly summary ----\n#yvirlit_wei     <- with(lgdvektAll, lgdvektAll[slag %in% Slag & oeki %in% Oeki,]) # some samples have no 'Oeki' registered\nyvirlit_wei     <- with(lgdvektAll, lgdvektAll[slag %in% Slag ,])\nyvirlit_wei$ls  <- as.character(bdrift[match(yvirlit_wei$drift, bdrift$drift), 'lysing_stutt'])\nyvirlit_wei     <- with(yvirlit_wei, yvirlit_wei[order(slag, arma, drift),])\nif(fleetCategory_question)\nyvirlit_wei$ls1 <- fleetCategory_UP[match(yvirlit_wei$drift, fleetCategory_UP$drift), 'fleet'] else {}\n\n# summary by 'drift' \nyvirlit_wei_mand <- with(yvirlit_wei, tapply(vekt, list(arma=arma, drift=drift),function(x) sum(!is.na(x))))\nyvirlit_wei_mand[is.na(yvirlit_wei_mand)] <- 0\n\nyvirlit_wei_mand <- raetRow(yvirlit_wei_mand)\n\n# summary by 'lysing_stutt'\nyvirlit_wei_man <- with(yvirlit_wei, tapply(vekt, list(arma=arma, ls=ls),function(x) sum(!is.na(x))))\nyvirlit_wei_man[is.na(yvirlit_wei_man)] <- 0\nncol_wei        <- ncol(yvirlit_wei_man)\nyvirlit_wei_man\n\nyvirlit_wei_man <- raetRow(yvirlit_wei_man)\n\n# summary by 'ls1' fleetCategory_UP\nyvirlit_wei_man1 <- with(yvirlit_wei, tapply(vekt, list(arma=arma, ls=ls1),function(x) sum(!is.na(x))))\nyvirlit_wei_man1[is.na(yvirlit_wei_man1)] <- 0\nncol_wei1        <- ncol(yvirlit_wei_man1)\nyvirlit_wei_man1\n\nyvirlit_wei_man1 <- raetRow(yvirlit_wei_man1)\n\n# ---- Quarter summary ---- by ls\nyvirlit_wei_qrt           <- data.frame(yvirlit_wei_man)\n#colnames(yvirlit_wei_qrt) <- gsub('X', '', colnames(yvirlit_wei_qrt))\nyvirlit_wei_qrt$extra     <- rep(1:qrt, each = qrt.l)\nyvirlit_wei_qrt           <- aggregate(yvirlit_wei_qrt[,1:ncol_wei], list(Qrt = yvirlit_wei_qrt$extra), sum)\ncolnames(yvirlit_wei_qrt) <- c('Qrt', colnames(yvirlit_wei_man))\nyvirlit_wei_qrt\n\n# ---- Quarter summary ---- by ls1\nyvirlit_wei_qrt1           <- data.frame(yvirlit_wei_man1)\n#colnames(yvirlit_lgd_qrt) <- gsub('X', '', colnames(yvirlit_lgd_qrt))\nyvirlit_wei_qrt1$extra     <- rep(1:qrt, each = qrt.l)\nyvirlit_wei_qrt1           <- aggregate(yvirlit_wei_qrt1[,1:ncol_wei1], list(Qrt = yvirlit_wei_qrt1$extra), sum)\ncolnames(yvirlit_wei_qrt1) <- c('Qrt',colnames(yvirlit_wei_man1))\nyvirlit_wei_qrt1\n\n#------------------------------------------------------\n######\t\tAge Summary\t\t#######\n#------------------------------------------------------\n# ---- Monthly summary ----\n#yvirlit_age     <- with(alkAll, alkAll[slag %in% Slag & oeki %in% Oeki,])\nyvirlit_age     <- with(alkAll, alkAll[slag %in% Slag,])\nyvirlit_age$ls  <- as.character(bdrift[match(yvirlit_age$drift, bdrift$drift), 'lysing_stutt'])\nyvirlit_age     <- with(yvirlit_age, yvirlit_age[order(slag, arma, drift, aldur),])\nif(fleetCategory_question)\nyvirlit_age$ls1 <- fleetCategory_UP[match(yvirlit_age$drift, fleetCategory_UP$drift), 'fleet'] else {}\n\n# summary by 'drift' \nyvirlit_age_mand <- with(yvirlit_age, tapply(tal, list(arma=arma, drift=drift),sum))\nyvirlit_age_mand[is.na(yvirlit_age_mand)] <- 0\n\nyvirlit_age_mand <- raetRow(yvirlit_age_mand)\n\n# summary by 'lysing_stutt'\nyvirlit_age_man <- with(yvirlit_age, tapply(tal, list(arma=arma, ls=ls),sum))\nyvirlit_age_man[is.na(yvirlit_age_man)] <- 0\nncol_age        <- ncol(yvirlit_age_man)\nyvirlit_age_man\n\nyvirlit_age_man <- raetRow(yvirlit_age_man)\n\n# summary by 'ls1' fleetCategory_UP\nyvirlit_age_man1 <- with(yvirlit_age, tapply(tal, list(arma=arma, ls=ls1),sum))\nyvirlit_age_man1[is.na(yvirlit_age_man1)] <- 0\nncol_age1        <- ncol(yvirlit_age_man1)\nyvirlit_age_man1\n\nyvirlit_age_man1 <- raetRow(yvirlit_age_man1)\n\n# ---- Quarter summary ---- by ls\nyvirlit_age_qrt           <- data.frame(yvirlit_age_man)\n#colnames(yvirlit_age_qrt) <- gsub('X', '', colnames(yvirlit_age_qrt))\nyvirlit_age_qrt$extra     <- rep(1:qrt, each = qrt.l)\nyvirlit_age_qrt           <- aggregate(yvirlit_age_qrt[,1:ncol_age], list(Qrt = yvirlit_age_qrt$extra), sum)\ncolnames(yvirlit_age_qrt) <- c('Qrt', colnames(yvirlit_age_man))\nyvirlit_age_qrt\n\n# ---- Quarter summary ---- by ls1\nyvirlit_age_qrt1           <- data.frame(yvirlit_age_man1)\n#colnames(yvirlit_lgd_qrt) <- gsub('X', '', colnames(yvirlit_lgd_qrt))\nyvirlit_age_qrt1$extra     <- rep(1:qrt, each = qrt.l)\nyvirlit_age_qrt1           <- aggregate(yvirlit_age_qrt1[,1:ncol_age1], list(Qrt = yvirlit_age_qrt1$extra), sum)\ncolnames(yvirlit_age_qrt1) <- c('Qrt',colnames(yvirlit_age_man1))\nyvirlit_age_qrt1\n\n\nif(dim(veidaDataAll)[1]!=0)\n{\n#------------------------------------------------------\n######\t\tLandings Summary\t\t#######\n#------------------------------------------------------\n# ---- Monthly summary ----\nyvirlit_lan     <- with(veidaDataAll, veidaDataAll[slag %in% Slag & oeki %in% Oeki,])\nyvirlit_lan$ls  <- as.character(bdrift[match(yvirlit_lan$drift, bdrift$drift), 'lysing_stutt'])\nyvirlit_lan     <- with(yvirlit_lan, yvirlit_lan[order(slag, arma, drift),])\nif(fleetCategory_question)\nyvirlit_lan$ls1 <- fleetCategory_UP[match(yvirlit_lan$drift, fleetCategory_UP$drift), 'fleet'] else {}\n\n# summary by 'drift' \nyvirlit_lan_mand <- with(yvirlit_lan, tapply(vekt,list(arma=arma, drift=drift),sum))\nyvirlit_lan_mand[is.na(yvirlit_lan_mand)] <- 0\n\nyvirlit_lan_mand <- raetRow(yvirlit_lan_mand)\n\n# summary by 'lysing_stutt'\nyvirlit_lan_man <- with(yvirlit_lan, tapply(vekt,list(arma=arma, ls=ls),sum))\nyvirlit_lan_man[is.na(yvirlit_lan_man)] <- 0\nncol_lan        <- ncol(yvirlit_lan_man)\nyvirlit_lan_man\n\nyvirlit_lan_man <- raetRow(yvirlit_lan_man)\n\n# summary by 'ls1' fleetCategory_UP\nyvirlit_lan_man1 <- with(yvirlit_lan, tapply(vekt,list(arma=arma, ls=ls1),sum))\nyvirlit_lan_man1[is.na(yvirlit_lan_man1)] <- 0\nncol_lan1        <- ncol(yvirlit_lan_man1)\nyvirlit_lan_man1\n\nyvirlit_lan_man1 <- raetRow(yvirlit_lan_man1)\n\n\n# ---- Quarter summary ---- by ls\nyvirlit_lan_qrt           <- data.frame(yvirlit_lan_man)\n#colnames(yvirlit_lan_qrt) <- gsub('X', '', colnames(yvirlit_lan_qrt))\nyvirlit_lan_qrt$extra     <- rep(1:qrt, each = qrt.l)\nyvirlit_lan_qrt           <- aggregate(yvirlit_lan_qrt[,1:ncol_lan], list(Qrt = yvirlit_lan_qrt$extra), sum)\ncolnames(yvirlit_lan_qrt) <- c('Qrt', colnames(yvirlit_lan_man))\nyvirlit_lan_qrt\n\n# ---- Quarter summary ---- by ls1\nyvirlit_lan_qrt1           <- data.frame(yvirlit_lan_man1)\n#colnames(yvirlit_lgd_qrt) <- gsub('X', '', colnames(yvirlit_lgd_qrt))\nyvirlit_lan_qrt1$extra     <- rep(1:qrt, each = qrt.l)\nyvirlit_lan_qrt1           <- aggregate(yvirlit_lan_qrt1[,1:ncol_lan1], list(Qrt = yvirlit_lan_qrt1$extra), sum)\ncolnames(yvirlit_lan_qrt1) <- c('Qrt',colnames(yvirlit_lan_man1))\nyvirlit_lan_qrt1\n}\n\n######  A handy summary of fleets and their numerical identification\ndrifts.stutt.all <- with(bdrift, tapply(drift, list(lysing_stutt), function(x) return(x)) )\ndrifts.stutt.all <- sapply(drifts.stutt.all, function(x) unique(x))\nif(dim(veidaDataAll)[1]!=0)\n{ drifts.stutt.sma <- unique(c(colnames(yvirlit_lgd_man),colnames(yvirlit_age_man),colnames(yvirlit_wei_man),colnames(yvirlit_lan_man))) } else \n{ drifts.stutt.sma <- unique(c(colnames(yvirlit_lgd_man),colnames(yvirlit_age_man),colnames(yvirlit_wei_man))) }\n###############\t###############\t###############\t###############\n\n# ------------------------------------------------------------------------\n#######\t SINK ALL THE SUMMARY RESULTS TO A FILE\t\t##############\n# ------------------------------------------------------------------------\nif(dim(veidaDataAll)[1]!=0)\n{\nsink(paste(\"Yvirlit\", \"_\",Slag,\"_\",year_yvirlit, \".txt\", sep=\"\"))\n\ncat(\"\\n\",\">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\")\ncat(\"\\n\", \"Dato            : \", date(), '\\n', \"Slag            : \", Slag, '\\n',\"T??arskei?      : \" , year_yvirlit , '\\n')\ncat(\" <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\",\"\\n\\n\")\n\nif(fleetCategory_question)\n{\ncat(\"Snella          : \"         ,c(Snella[,2]          ),'\\n')\ncat(\"Partroplus1000  : \"         ,c(Partroplus1000[,2]  ),'\\n')\ncat(\"Partrominus1000 : \"         ,c(Partrominus1000[,2] ),'\\n')\ncat(\"Lemmatroplus1000: \"         ,c(Lemmatroplus1000[,2]),'\\n')\ncat(\"Annad1          : \"         ,c(Annad1[,2]          ),'\\n')\ncat(\"Annad2          : \"         ,c(Annad2[,2]          ),'\\n')\n} else { \ndrifts.stutt_ind  <-  names(drifts.stutt.all) %in% drifts.stutt.sma\ndrifts.stutt   <- drifts.stutt.all[drifts.stutt_ind]\nprint(drifts.stutt) }\n\ncat('\\n\\n-------------------------- Lengths-summary -------------------------- \\n')\nprint(yvirlit_lgd_mand)\ncat('\\n')\nprint(yvirlit_lgd_man1)\ncat('\\n')\nprint(yvirlit_lgd_qrt1)\ncat('\\n-------------------------- Weight-summary  -------------------------- \\n')\nprint(yvirlit_wei_mand)\ncat('\\n')\nprint(yvirlit_wei_man1)\ncat('\\n')\nprint(yvirlit_wei_qrt1)\ncat('\\n-------------------------- Age-summary     --------------------------- \\n')\nprint(yvirlit_age_mand)\ncat('\\n')\nprint(yvirlit_age_man1)\ncat('\\n')\nprint(yvirlit_age_qrt1)\ncat('\\n-------------------------- Landings-summary -------------------------- \\n')\nprint(yvirlit_lan_mand)\ncat('\\n')\nprint(yvirlit_lan_man1)\ncat('\\n')\nprint(yvirlit_lan_qrt1)\n\nsink()\n} else {\n\nsink(paste(\"Yvirlit\", \"_\",Slag,\"_\",year_yvirlit, \".txt\", sep=\"\"))\n\ncat(\"\\n\",\">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\")\ncat(\"\\n\", \"Dato            : \", date(), '\\n', \"Slag            : \", Slag, '\\n',\"T??arskei?      : \" , year_yvirlit , '\\n')\ncat(\" <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\",\"\\n\\n\")\n\nif(fleetCategory_question)\n{\ncat(\"Snella          : \"         ,c(Snella[,2]          ),'\\n')\ncat(\"Partroplus1000  : \"         ,c(Partroplus1000[,2]  ),'\\n')\ncat(\"Partrominus1000 : \"         ,c(Partrominus1000[,2] ),'\\n')\ncat(\"Lemmatroplus1000: \"         ,c(Lemmatroplus1000[,2]),'\\n')\ncat(\"Annad1          : \"         ,c(Annad1[,2]          ),'\\n')\ncat(\"Annad2          : \"         ,c(Annad2[,2]          ),'\\n')\n} else { \ndrifts.stutt_ind  <-  names(drifts.stutt.all) %in% drifts.stutt.sma\ndrifts.stutt   <- drifts.stutt.all[drifts.stutt_ind]\nprint(drifts.stutt) }\n\n\ncat('\\n\\n-------------------------- Lengths-summary -------------------------- \\n')\nprint(yvirlit_lgd_mand)\ncat('\\n')\nprint(yvirlit_lgd_man1)\ncat('\\n')\nprint(yvirlit_lgd_qrt1)\ncat('\\n-------------------------- Weight-summary  -------------------------- \\n')\nprint(yvirlit_wei_mand)\ncat('\\n')\nprint(yvirlit_wei_man1)\ncat('\\n')\nprint(yvirlit_wei_qrt1)\ncat('\\n-------------------------- Age-summary     -------------------------- \\n')\nprint(yvirlit_age_mand)\ncat('\\n')\nprint(yvirlit_age_man1)\ncat('\\n')\nprint(yvirlit_age_qrt1)\nsink()\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1417443219797.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3146605882",
    "id" : "C1764645",
    "lastKnownWriteTime" : 1417447352,
    "path" : "~/Documents/D/ALKiR/yvirlit.R",
    "project_path" : "yvirlit.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}